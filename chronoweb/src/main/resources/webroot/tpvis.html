<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="description" content="" />
<meta name="author" content="" />

<title>Chronoweb - Home</title>

<!-- Custom fonts for this template-->
<link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet"
	type="text/css" />
<link
	href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
	rel="stylesheet" />
<!-- Custom styles for this template-->
<link href="css/sb-admin-2.min.css" rel="stylesheet" />
</head>
<!-- Bootstrap core JavaScript-->
<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- Core plugin JavaScript-->
<script src="vendor/jquery-easing/jquery.easing.min.js"></script>
<!-- Custom scripts for all pages-->
<script src="js/sb-admin-2.min.js"></script>
<script src="js/chronoweb.js"></script>
<script src="vendor/d3/d3.v7.js"></script>
<script defer>
		// Connection to the server
		$(document).ready(() => {
			// Connection to the server
			const href = window.location.href;
			let hrefArr = href.split("/");
			let baseURL = hrefArr[0] + "//" + hrefArr[2] + "/chronoweb";

			serverConn(baseURL, "#serverResp");
			setInterval(serverConn.bind(baseURL, "#serverResp"), 3000);
			
			// Specify the dimensions of the chart.
			  const width = 928;
			  const height = 600;

			  // Specify the color scale.
			  const color = d3.scaleOrdinal(d3.schemeCategory10);

			  // The force simulation mutates links and nodes, so create a copy
			  // so that re-evaluating this cell produces the same result.
			  
			  data = {
				nodes: [
					{ id: "a", group: 1}, { id: "b", group: 1}, { id: "c", group:1}
				],
				links: [
					{ source: "a", target: "b", value: 1}, { source: "b", target: "c", value: 1}, { source: "c", target: "a", value: 1}
				] 
			  }
			  
			  const links = data.links.map(d => ({...d}));
			  const nodes = data.nodes.map(d => ({...d}));

			  // Create a simulation with several forces.
			  const simulation = d3.forceSimulation(nodes)
			      .force("link", d3.forceLink(links).id(d => d.id))
			      .force("charge", d3.forceManyBody())
			      .force("center", d3.forceCenter(width / 2, height / 2))
			      .on("tick", ticked);

			  // Create the SVG container.
			  const svg = d3.create("svg")
			      .attr("width", width)
			      .attr("height", height)
			      .attr("viewBox", [0, 0, width, height])
			      .attr("style", "max-width: 100%; height: auto;");

			  // Add a line for each link, and a circle for each node.
			  const link = svg.append("g")
			      .attr("stroke", "#999")
			      .attr("stroke-opacity", 0.6)
			    .selectAll()
			    .data(links)
			    .join("line")
			      .attr("stroke-width", d => Math.sqrt(d.value));

			  const node = svg.append("g")
			      .attr("stroke", "#fff")
			      .attr("stroke-width", 1.5)
			    .selectAll()
			    .data(nodes)
			    .join("circle")
			      .attr("r", 5)
			      .attr("fill", d => color(d.group));

			  node.append("title")
			      .text(d => d.id);

			  // Add a drag behavior.
			  node.call(d3.drag()
			        .on("start", dragstarted)
			        .on("drag", dragged)
			        .on("end", dragended));

			  // Set the position attributes of links and nodes each time the simulation ticks.
			  function ticked() {
			    link
			        .attr("x1", d => d.source.x)
			        .attr("y1", d => d.source.y)
			        .attr("x2", d => d.target.x)
			        .attr("y2", d => d.target.y);

			    node
			        .attr("cx", d => d.x)
			        .attr("cy", d => d.y);
			  }

			  // Reheat the simulation when drag starts, and fix the subject position.
			  function dragstarted(event) {
			    if (!event.active) simulation.alphaTarget(0.3).restart();
			    event.subject.fx = event.subject.x;
			    event.subject.fy = event.subject.y;
			  }

			  // Update the subject (dragged node) position during drag.
			  function dragged(event) {
			    event.subject.fx = event.x;
			    event.subject.fy = event.y;
			  }

			  // Restore the target alpha so the simulation cools after dragging ends.
			  // Unfix the subject position now that it’s no longer being dragged.
			  function dragended(event) {
			    if (!event.active) simulation.alphaTarget(0);
			    event.subject.fx = null;
			    event.subject.fy = null;
			  }

			  // When this cell is re-run, stop the previous simulation. (This doesn’t
			  // really matter since the target alpha is zero and the simulation will
			  // stop naturally, but it’s a good practice.)
			  // invalidation.then(() => simulation.stop());

			// Append the SVG element.
			$("#container").append(svg.node());
		});
</script>

<body id="page-top">
	<!-- Page Wrapper -->
	<div id="wrapper">
		<!-- Sidebar -->
		<ul id="sidebar"
			class="navbar-nav bg-gradient-custom sidebar sidebar-dark accordion"
			id="accordionSidebar">
		</ul>

		<!-- Content Wrapper -->
		<div id="content-wrapper" class="d-flex flex-column">
			<!-- Main Content -->
			<div id="content">
				<!-- Topbar -->
				<nav
					class="navbar navbar-expand navbar-light bg-white topbar static-top shadow d-md-none">
					<!-- Sidebar Toggle (Topbar) -->
					<button id="sidebarToggleTop"
						class="btn btn-link rounded-circle mr-3">
						<i class="fa fa-bars"></i>
					</button>
				</nav>
				<!-- End of Topbar -->

				<div class="bg-header pt-4 pb-3">
					<div class="pt-4 px-5">
						<h1 class="h1 text-gray-100 font-weight-bold mb-4">Temporal
							Path Visualization (TPVis)</h1>

						<div class="text-gray-100">
							<p>TPVis visualizes information flow over time from a
								specific vertex event.</p>
						</div>
					</div>

					<!-- Toast container -->
					<div style="position: absolute; top: 1rem; right: 1rem;">
						<!-- Toast -->
						<div class="toast toast-right-top" id="responseToast" role="alert"
							aria-live="assertive" aria-atomic="true" data-delay="3000">
							<div class="toast-header">
								<i data-feather="bell"></i> <strong class="mr-auto">Reset
									Response</strong>
								<button class="ml-5 mb-1 close" type="button"
									data-dismiss="toast" aria-label="Close">&times;</button>
							</div>
							<div class="toast-body"></div>
						</div>
					</div>
				</div>
				<div class="row mt-n8 px-5">
					<div class="col-lg-12">
						<div class="card shadow mb-14">

							<div class="card-header py-3">

								<div class="row">
									<div class="col-sm">
										<div class="form-group row">
											<button id="searchGammaTables" type="button"
												class="btn btn-primary">Search</button>
											<div class="dropdown invisible">
												<button class="btn btn-secondary dropdown-toggle"
													type="button" id="gammaTablesMenuButton"
													data-toggle="dropdown" aria-haspopup="true"
													aria-expanded="false">Select</button>
												<div class="dropdown-menu" id="gammaTablesMenuItems"
													aria-labelledby="dropdownMenuButton"></div>
											</div>
											<button type="button" class="btn btn-primary invisible">Visualize</button>
											<div id="serverEndpoint" class="text-xs"></div>
											<div id="serverResp" class="rounded-circle bg-danger Blink2"
												style="width: 15px; height: 15px;"></div>
										</div>
									</div>
								</div>

							</div>
							<div class="card-body" id="container"></div>
						</div>

					</div>
				</div>
			</div>

			<!-- Footer -->

			<footer id="footer" class="sticky-footer bg-footer mt-4"> </footer>
			<!-- End of Footer -->
		</div>
		<!-- End of Content Wrapper -->
	</div>
	<!-- End of Page Wrapper -->



	<!-- Load Sidebar & Footer -->
	<script type="text/javascript">
		$("#sidebar").load("sidebar.html", () => {
			$("#sidebarToggle").click(function (e) {
				e.preventDefault();
				$("body").toggleClass("sidebar-toggled");
				$(".sidebar").toggleClass("toggled");
				if ($(".sidebar").hasClass("toggled")) {
					$(".sidebar .collapse").collapse("hide");
				}
			});
		});
		$("#footer").load("footer.html");
	</script>
</body>

</html>